{% load static i18n wagtailuserbar wagtailcore_tags wagtailimages_tags storengine %}
{% wagtail_site as current_site %}
{% get_current_language as LANGUAGE_CODE %}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ current_site.site_name }}{% endblock %}</title>
    <link href="{% static 'storengine/images/rocket-earth.png' %}" rel="shortcut icon" type="image/x-icon">
    <link href="{% static 'storengine/images/rocket-earth.png' %}" rel="apple-touch-icon">

    <meta property="og:title" content="{% block og_title %}{{ current_site.site_name }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{% endblock %}">
    <meta name="description" content="{% block description %}{% endblock %}">
    <meta name="keywords" content={% block keywords %}{% endblock %}>


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
          integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="{{ settings.core.BrandSettings.google_font.url }}|Oswald" rel="stylesheet">


    <link rel="stylesheet" href="{% static 'storengine/css/style.css' %}" type="text/css">

    <script src="https://unpkg.com/htmx.org@1.7.0"
            integrity="sha384-EzBXYPt0/T6gxNp0nuPtLkmRpmDBbjg6WmCUZRLXBBwYYmwAUxzlSGej0ARHX0Bo"
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"
            integrity="sha256-eGE6blurk5sHj+rmkfsGYeKyZx3M4bG+ZlFyA7Kns7E=" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

    <script src="{% static 'storengine/js/main.js' %}"></script>
    <script src="{% static 'storengine/js/in-view.min.js' %}"></script>
    <script src="{% static 'storengine/js/splide.min.js' %}"></script>

    <style>
        * {
            font-family: '{{ settings.core.BrandSettings.google_font.family }}',{{ settings.core.BrandSettings.google_font.category }};
            text-align: left;
        }

        {% if settings.core.BrandSettings.footer_image %}
            footer {
                background: url("{% image_url settings.core.BrandSettings.footer_image "fill-1920x1080-c100" %}") center;
                background-size: cover;
            }
        {% endif %}

        footer::after {
            background: {{ settings.core.BrandSettings.primary_color }};
        {% if settings.core.BrandSettings.show_footer_waves %}
            position: absolute;
            content: '';
            width: 100%;
            height: 120px;
            top: -1px;
            left: 0;
            /* ID from SVGs Clip Path*/
            clip-path: url(#waveDown3);
        {% endif %}
        }

        main {
            background: {{ settings.core.BrandSettings.primary_color }};
        }

        hr {
            background: {{ settings.core.BrandSettings.text_color }};
        }

        .errorlist {
            color: {{ settings.core.BrandSettings.error_color }};
        }

        #cart {
            background: {{ settings.core.BrandSettings.cart_color }};
            color: {{ settings.core.BrandSettings.cart_text_color }};
        }

        .cart-item {
            border-color: {{ settings.core.BrandSettings.cart_text_color }};
        }

        .cta {
            background: {{ settings.core.BrandSettings.accent_color }};
        }
    </style>
    {% block extrahead %}
    {% endblock %}
</head>
<body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
{% wagtailuserbar %}
{% cart as cart %}
<div class="holder" id="holder">
    {% if content_settings.notification_bar_show %}
        <div class="notification" id="notification">
            <span class="notification-text">{{ content_settings.notification_bar_text }}</span>
            <span class="icon" id="closeNotification">
            <i class="fa fa-times"></i>
        </span>
        </div>
    {% endif %}
    <nav class="main-navbar" role="navigation">
        <span class="navbar-toggle" id="js-navbar-toggle">
            <i class="fas fa-bars"></i>
        </span>
        <a href="/">
            {% if settings.core.BrandSettings.logo %}
                <img class="logo" src="{{ settings.core.BrandSettings.logo.url }}" alt="Logo">
            {% else %}
                <img class="logo" src="{% static 'storengine/images/rocket-earth.png' %}" alt="Logo">
            {% endif %}
        </a>
        <ul class="main-nav" id="js-menu">
            {% for page in menu_pages|filter_by_locale:LANGUAGE_CODE %}
                <li><a href="{% if page.url_path.lower != '/home/' %}/{{ page.slug }}/{% else %}/{% endif %}"
                       class="nav-links">{{ page.title.upper }}</a></li>
            {% endfor %}
            {% if locales.count > 1 %}
                <form action="{% url 'set_language' %}" method="post" id="language-form">
                    {% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.get_full_path }}"/>
                    <select name="language" id="language-select" onchange="this.form.submit()">
                        {% for locale in locales %}
                            <option value="{{ locale.language_code }}"
                                    {% if locale.language_code == LANGUAGE_CODE %}selected{% endif %}>
                                {{ locale.language_code.upper }}
                            </option>
                        {% endfor %}
                    </select>
                </form>
            {% endif %}
            <li id="nav-link-cart" title="{% trans 'Cart' %}">
                {% if cart %}
                    <div id="cart-counter">{{ cart.items.count }}</div>
                {% endif %}
                <i class="fas fa-shopping-cart nav-links"></i>
            </li>
            {% comment %}
                <li><a href="{% url 'profile' %}" class="nav-links" title="{% trans 'Account' %}"><i
                        class="fas fa-user"></i></a></li>
                {% if user.is_authenticated %}
                    <li><a href="{% url 'logout' %}" class="nav-links" title="{% trans 'Log Out' %}"><i
                            class="fas fa-sign-out-alt"></i></a></li>
                {% endif %}
            {% endcomment %}

        </ul>
    </nav>
</div>
<main role="main">
    {% block content %}
    {% endblock %}
</main>
<footer>
    <div class="footer-section">
        Store Engine<br/>
        Eshop solution
    </div>
    <div class="footer-section">
        <p>
            <a href="mailto:{{ settings.core.ContactSettings.email }}">{{ settings.core.ContactSettings.email }}</a>
        </p>
        <div class="social-footer">
            {% for link in settings.core.ContactSettings.social_links.all %}
                {% if link.is_active %}
                    <a href="{{ link.url }}" target="_blank">
                        {% image link.icon fill-30x30-c100 %}
                    </a>
                {% endif %}
            {% endfor %}
        </div>
        Â© {{ settings.core.ContactSettings.full_name }} {% now "Y" %}
    </div>
    <div class="footer-section">
        {% for page in menu_pages|filter_by_locale:LANGUAGE_CODE %}
            <a href="{% if page.url_path.lower != '/home/' %}/{{ page.slug }}/{% else %}/{% endif %}">
                {{ page.title.upper }}
            </a>
        {% endfor %}
    </div>
    <a href="https://storengine.org" target="_blank" title="Store Engine Powered" class="footer-lottie">
        <lottie-player src="{% static 'storengine/images/rocket-ship.json' %}" background="transparent" speed="1"
                       style="width: 60px;" loop autoplay></lottie-player>
    </a>
</footer>
{% if not request.session.cookies_preferences_set %}
    {% include "storengine/includes/_cookie_bar.html" %}
{% endif %}
<div class="svgs">
    {% include "storengine/includes/_svgs.html" %}
</div>
<div id="cart">
    {% include "storengine/includes/_cart.html" %}
</div>
</body>
</html>