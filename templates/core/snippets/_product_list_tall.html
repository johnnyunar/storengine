{% extends 'core/snippets/_base_section.html' %}
{% load static i18n l10n djmoney wagtailimages_tags %}

{% block extra_attrs %}
    class="d-flex";
{% endblock %}

{% block section_content %}
    {% for product in section.products.all %}
        {% with product.product as product %}
             {% image_url product.image "width-500" as image_url %}
            <div class="product-card-tall" id="product-{{ product.pk }}"
                 style="background-image: url('{{ image_url }}'); box-shadow: inset 0 0 0 200px rgba(33, 33, 33, 0.7), 0px 7px 9px -1px rgba(0, 0, 0, 0.55);">
                <div class="card-text no-select">
                    <h3>{{ product.name }}</h3>
                    {{ product.description | safe }}
                </div>
                <span class="price">{% money_localize product.price %}</span>
                <br/><br/>
                {% if product.external_url %}
                    <a href="{{ product.external_url }}" target="_blank" rel="noopener"
                       class="card-cta">{% trans "Buy Now" %}</a>
                {% else %}
                    <button hx-post="{% url 'shop:add_to_cart' %}" hx-target='#cart'
                            hx-vals='{"item": {{ product.pk }}}'
                            class="card-cta add-to-cart">{% trans "Add To Cart" %}</button>
                {% endif %}
            </div>
        {% endwith %}
    {% empty %}
        <h2>{% trans "Come back later!" %}</h2>
    {% endfor %}
    <script src="{% static 'shop/js/shop.js' %}"></script>
{% endblock %}